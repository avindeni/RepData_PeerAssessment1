# Reproducible Research Week 2

## This is my Course 5 Reproducible Research R Markdown File

library(ggplot2)
library(knitr)

### Loading and Preprocessing Data

```r
activity <- read.csv("activity.csv", na.strings="")
```

### What is the mean total number of steps per day?

```r
activityFull <- activity[which(activity$steps!="NA"),]
activityFullSum <- tapply(as.numeric(activityFull$steps), activityFull$date, sum)
hist(activityFullSum)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2-1.png)

```r
activityFullMean <- tapply(as.numeric(activityFull$steps), activityFull$date, mean)
print(activityFullMean)
```

```
## 2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-06 
##         NA   3.177083  89.215278 101.864583  89.006944 108.420139 
## 2012-10-07 2012-10-08 2012-10-09 2012-10-10 2012-10-11 2012-10-12 
## 104.527778         NA  89.118056  99.642361  82.520833 121.920139 
## 2012-10-13 2012-10-14 2012-10-15 2012-10-16 2012-10-17 2012-10-18 
## 112.319444 102.062500  92.718750  99.913194  97.059028  70.531250 
## 2012-10-19 2012-10-20 2012-10-21 2012-10-22 2012-10-23 2012-10-24 
##  93.229167  89.444444  89.982639  90.159722  82.291667  80.256944 
## 2012-10-25 2012-10-26 2012-10-27 2012-10-28 2012-10-29 2012-10-30 
##  46.006944  66.114583  71.065972 102.527778  62.663194  82.725694 
## 2012-10-31 2012-11-01 2012-11-02 2012-11-03 2012-11-04 2012-11-05 
##  90.607639         NA  83.951389  98.687500         NA  80.263889 
## 2012-11-06 2012-11-07 2012-11-08 2012-11-09 2012-11-10 2012-11-11 
##  75.402778  89.833333  55.652778         NA         NA 103.218750 
## 2012-11-12 2012-11-13 2012-11-14 2012-11-15 2012-11-16 2012-11-17 
##  67.236111  82.885417         NA   3.881944  58.520833  90.777778 
## 2012-11-18 2012-11-19 2012-11-20 2012-11-21 2012-11-22 2012-11-23 
##  98.631944  82.798611  44.277778  77.461806 119.777778  92.184028 
## 2012-11-24 2012-11-25 2012-11-26 2012-11-27 2012-11-28 2012-11-29 
##  85.024306  81.347222 100.055556  90.152778  55.572917  60.090278 
## 2012-11-30 
##         NA
```

```r
activityFullMedian <- tapply(as.numeric(activityFull$steps), activityFull$date, median)
print(activityFullMedian)
```

```
## 2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-06 
##         NA          1          1          1          1          1 
## 2012-10-07 2012-10-08 2012-10-09 2012-10-10 2012-10-11 2012-10-12 
##          1         NA          1          1          1          1 
## 2012-10-13 2012-10-14 2012-10-15 2012-10-16 2012-10-17 2012-10-18 
##          1          1          1          1          1          1 
## 2012-10-19 2012-10-20 2012-10-21 2012-10-22 2012-10-23 2012-10-24 
##          1          1          1          1          1          1 
## 2012-10-25 2012-10-26 2012-10-27 2012-10-28 2012-10-29 2012-10-30 
##          1          1          1          1          1          1 
## 2012-10-31 2012-11-01 2012-11-02 2012-11-03 2012-11-04 2012-11-05 
##          1         NA          1          1         NA          1 
## 2012-11-06 2012-11-07 2012-11-08 2012-11-09 2012-11-10 2012-11-11 
##          1          1          1         NA         NA          1 
## 2012-11-12 2012-11-13 2012-11-14 2012-11-15 2012-11-16 2012-11-17 
##          1          1         NA          1          1          1 
## 2012-11-18 2012-11-19 2012-11-20 2012-11-21 2012-11-22 2012-11-23 
##          1          1          1          1          1          1 
## 2012-11-24 2012-11-25 2012-11-26 2012-11-27 2012-11-28 2012-11-29 
##          1          1          1          1          1          1 
## 2012-11-30 
##         NA
```

### What is the average daily activityFull pattern?

```r
activityFullPlot<-tapply(as.numeric(activityFull$steps), activityFull$interval, mean)
plot(y=activityFullPlot, x=unique(activityFull$interval), type="l")
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-1.png)

```r
names(activityFullPlot[which(activityFullPlot==max(activityFullPlot))])
```

```
## [1] "1845"
```

### Imputing Missing Values

```r
length(which(activity$steps=="NA"))
```

```
## [1] 2304
```

```r
activityImpute <- activity
names(activityFullPlot[which(activityFullPlot==max(activityFullPlot))])
```

```
## [1] "1845"
```

```r
Means <- lapply(activityImpute[which(activityImpute$steps=="NA"), 1], function(x) {activityFullPlot[which(names(activityFullPlot)==activityImpute[x, 3])]})
activityImpute <- activityImpute[which(activityImpute$steps!="NA"),]
activityImputeNa <- activityImpute[which(activityImpute$steps=="NA"),]
activityImputeNa <- cbind(as.character(round(unlist(Means))), as.character(activityImputeNa[,2]), activityImputeNa[,3])
activityImputeNa <- as.data.frame(activityImputeNa)
activityImputeNa <- colnames(c("steps", "date", "interval"))
activityImpute <- rbind(activityImpute, activityImputeNa)

activityImputeSum <- tapply(as.numeric(activityImpute$steps), activityImpute$date, sum)
hist(activityImputeSum)
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4-1.png)

```r
activityImputeMean <- tapply(as.numeric(activityImpute$steps), activityImpute$date, mean)
print(activityImputeMean)
```

```
## 2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-06 
##         NA   3.177083  89.215278 101.864583  89.006944 108.420139 
## 2012-10-07 2012-10-08 2012-10-09 2012-10-10 2012-10-11 2012-10-12 
## 104.527778         NA  89.118056  99.642361  82.520833 121.920139 
## 2012-10-13 2012-10-14 2012-10-15 2012-10-16 2012-10-17 2012-10-18 
## 112.319444 102.062500  92.718750  99.913194  97.059028  70.531250 
## 2012-10-19 2012-10-20 2012-10-21 2012-10-22 2012-10-23 2012-10-24 
##  93.229167  89.444444  89.982639  90.159722  82.291667  80.256944 
## 2012-10-25 2012-10-26 2012-10-27 2012-10-28 2012-10-29 2012-10-30 
##  46.006944  66.114583  71.065972 102.527778  62.663194  82.725694 
## 2012-10-31 2012-11-01 2012-11-02 2012-11-03 2012-11-04 2012-11-05 
##  90.607639         NA  83.951389  98.687500         NA  80.263889 
## 2012-11-06 2012-11-07 2012-11-08 2012-11-09 2012-11-10 2012-11-11 
##  75.402778  89.833333  55.652778         NA         NA 103.218750 
## 2012-11-12 2012-11-13 2012-11-14 2012-11-15 2012-11-16 2012-11-17 
##  67.236111  82.885417         NA   3.881944  58.520833  90.777778 
## 2012-11-18 2012-11-19 2012-11-20 2012-11-21 2012-11-22 2012-11-23 
##  98.631944  82.798611  44.277778  77.461806 119.777778  92.184028 
## 2012-11-24 2012-11-25 2012-11-26 2012-11-27 2012-11-28 2012-11-29 
##  85.024306  81.347222 100.055556  90.152778  55.572917  60.090278 
## 2012-11-30 
##         NA
```

```r
activityImputeMedian <- tapply(as.numeric(activityImpute$steps), activityImpute$date, median)
print(activityImputeMedian)
```

```
## 2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-06 
##         NA          1          1          1          1          1 
## 2012-10-07 2012-10-08 2012-10-09 2012-10-10 2012-10-11 2012-10-12 
##          1         NA          1          1          1          1 
## 2012-10-13 2012-10-14 2012-10-15 2012-10-16 2012-10-17 2012-10-18 
##          1          1          1          1          1          1 
## 2012-10-19 2012-10-20 2012-10-21 2012-10-22 2012-10-23 2012-10-24 
##          1          1          1          1          1          1 
## 2012-10-25 2012-10-26 2012-10-27 2012-10-28 2012-10-29 2012-10-30 
##          1          1          1          1          1          1 
## 2012-10-31 2012-11-01 2012-11-02 2012-11-03 2012-11-04 2012-11-05 
##          1         NA          1          1         NA          1 
## 2012-11-06 2012-11-07 2012-11-08 2012-11-09 2012-11-10 2012-11-11 
##          1          1          1         NA         NA          1 
## 2012-11-12 2012-11-13 2012-11-14 2012-11-15 2012-11-16 2012-11-17 
##          1          1         NA          1          1          1 
## 2012-11-18 2012-11-19 2012-11-20 2012-11-21 2012-11-22 2012-11-23 
##          1          1          1          1          1          1 
## 2012-11-24 2012-11-25 2012-11-26 2012-11-27 2012-11-28 2012-11-29 
##          1          1          1          1          1          1 
## 2012-11-30 
##         NA
```

```r
print("0's mean no change")
```

```
## [1] "0's mean no change"
```

```r
impactMean <- activityFullMean - activityImputeMean
print(impactMean)
```

```
## 2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-06 
##         NA          0          0          0          0          0 
## 2012-10-07 2012-10-08 2012-10-09 2012-10-10 2012-10-11 2012-10-12 
##          0         NA          0          0          0          0 
## 2012-10-13 2012-10-14 2012-10-15 2012-10-16 2012-10-17 2012-10-18 
##          0          0          0          0          0          0 
## 2012-10-19 2012-10-20 2012-10-21 2012-10-22 2012-10-23 2012-10-24 
##          0          0          0          0          0          0 
## 2012-10-25 2012-10-26 2012-10-27 2012-10-28 2012-10-29 2012-10-30 
##          0          0          0          0          0          0 
## 2012-10-31 2012-11-01 2012-11-02 2012-11-03 2012-11-04 2012-11-05 
##          0         NA          0          0         NA          0 
## 2012-11-06 2012-11-07 2012-11-08 2012-11-09 2012-11-10 2012-11-11 
##          0          0          0         NA         NA          0 
## 2012-11-12 2012-11-13 2012-11-14 2012-11-15 2012-11-16 2012-11-17 
##          0          0         NA          0          0          0 
## 2012-11-18 2012-11-19 2012-11-20 2012-11-21 2012-11-22 2012-11-23 
##          0          0          0          0          0          0 
## 2012-11-24 2012-11-25 2012-11-26 2012-11-27 2012-11-28 2012-11-29 
##          0          0          0          0          0          0 
## 2012-11-30 
##         NA
```

```r
impactMedian <- activityFullMedian - activityImputeMedian
print(impactMedian)
```

```
## 2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-06 
##         NA          0          0          0          0          0 
## 2012-10-07 2012-10-08 2012-10-09 2012-10-10 2012-10-11 2012-10-12 
##          0         NA          0          0          0          0 
## 2012-10-13 2012-10-14 2012-10-15 2012-10-16 2012-10-17 2012-10-18 
##          0          0          0          0          0          0 
## 2012-10-19 2012-10-20 2012-10-21 2012-10-22 2012-10-23 2012-10-24 
##          0          0          0          0          0          0 
## 2012-10-25 2012-10-26 2012-10-27 2012-10-28 2012-10-29 2012-10-30 
##          0          0          0          0          0          0 
## 2012-10-31 2012-11-01 2012-11-02 2012-11-03 2012-11-04 2012-11-05 
##          0         NA          0          0         NA          0 
## 2012-11-06 2012-11-07 2012-11-08 2012-11-09 2012-11-10 2012-11-11 
##          0          0          0         NA         NA          0 
## 2012-11-12 2012-11-13 2012-11-14 2012-11-15 2012-11-16 2012-11-17 
##          0          0         NA          0          0          0 
## 2012-11-18 2012-11-19 2012-11-20 2012-11-21 2012-11-22 2012-11-23 
##          0          0          0          0          0          0 
## 2012-11-24 2012-11-25 2012-11-26 2012-11-27 2012-11-28 2012-11-29 
##          0          0          0          0          0          0 
## 2012-11-30 
##         NA
```

### Are there differences in activity patterns between weekdays and weekends?


```r
days <- weekdays(as.POSIXct(activityImpute$date))
days[which(days=="Sunday" | days=="Saturday")] <- c("weekend")
days[which(days!="weekend")] <- c("weekday")
activityImpute <- cbind(activityImpute, days)
activityImputePlot<-tapply(as.numeric(activityImpute$steps), activityImpute$interval, mean)
qplot(x=unique(activityImpute$interval), y=as.numeric(unlist(activityImputePlot)), shape="line") + facet_grid(activityImpute$days~.)+geom_line()
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-5-1.png)
